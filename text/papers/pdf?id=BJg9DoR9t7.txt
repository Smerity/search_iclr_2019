Under review as a conference paper at ICLR 2019
MAX-MIG: AN INFORMATION THEORETIC APPROACH FOR JOINT LEARNING FROM CROWDS
Anonymous authors Paper under double-blind review
ABSTRACT
Eliciting labels from crowds is a potential way to obtain large labeled data. Despite a variety of methods developed for learning from crowds, a key challenge remains unsolved: learning from crowds without knowing the information structure among the crowds a priori, when some people of the crowds make highly correlated mistakes and some of them label effortlessly (e.g. randomly). We propose an information theoretic approach, Max-MIG, for joint learning from crowds, with a common assumption: the crowdsourced labels and the data are independent conditioning on the ground truth. Max-MIG simultaneously aggregates the crowdsourced labels and learns an accurate data classifier. Furthermore, we devise an accurate data-crowds forecaster that employs both the data and the crowdsourced labels to forecast the ground truth. To the best of our knowledge, this is a very early algorithm that solves the aforementioned challenge of learning from crowds. In addition to the theoretical validation, we also empirically show that our algorithm achieve the new state-of-the-art results in most settings and is a very early algorithm that is robust to various information structures.
1 INTRODUCTION
Lack of large labeled data is a notorious bottleneck of data-driven-based machine learning paradigm. Crowdsourcing provides a potential solution to this challenge: eliciting labels from crowds. However, the elicited labels are usually very noisy, especially for some difficult tasks (e.g. age estimation, medical images annotation). In the crowdsourcing-learning scenario, two problems are raised:
(i) how to aggregate and infer the ground truth from the imperfect crowdsourced labels?
(ii) how to learn an accurate data classifier with the imperfect crowdsourced labels?
One conventional solution to the two problems is aggregating the crowdsourced labels using majority vote and then learning a data classifier with the majority answer. However, this naive method will cause biased results when the task is difficult and the majority of the crowds label randomly or always label a particular class (say class 1) effortlessly.
Another typical solution is aggregating the crowdsourced labels in a more clever way, like spectral method (Dalvi et al., 2013; Zhang et al., 2014), and then learning with the aggregated results. This method avoids the above flaw that the majority vote method has, as long as their randomnesses are mutually independent. However, the spectral method requires that the experts' labeling noise are mutually independent, which often does not hold in practice since some experts may make highly correlated mistakes (see Figure 2 for example). Moreover, the above solutions aim to train an accurate data classifier and do not provide a method that can employ both the data and the crowdsourced labels to forecast the ground truth.
A common assumption in the learning from crowds literature is that conditioning on the ground truth, the crowdsourced labels and the data are independent, as shown in Figure 1 (a). Under this assumption, the crowdsourced labels correlate with the data due to and only due to the ground truth. Thus, this assumption tells us the ground truth is the "information intersection" between the crowdsourced labels and the data. This "information intersection" assumption does not restrict the information structure among the crowds i.e. this assumption still holds even if some people of the crowds make highly correlated mistakes.
1

Under review as a conference paper at ICLR 2019
Figure 1: (a) The general information structure under the "information intersection" assumption. (b) Possible information structures under the "information intersection" assumption, where the crowdsourced labels are provided by several experts: (1) independent mistakes: all of the experts are correlated with the ground truth and mutually independent of each other conditioning on the ground truth; for (2), (3) the senior experts are mutually conditional independent and (2) naive majority: the junior experts always label class 1 without any effort; (3) correlated mistakes: the junior experts, who were advised by the same senior expert before, make highly correlated mistakes.
We present several possible information structures under the "information intersection" assumption in Figure 1 (b). The majority vote will lead to inaccurate results in all cases if the experts have different levels of expertise and will induce extremely biased results in case (2) when a large number of junior experts always label class 1. The approaches that require the experts to make independent mistakes will lead to biased results in case (3), when the experts make highly correlated mistakes1. In this paper, we propose an information theoretic approach, Max-MIG, for joint learning from crowds, with a common assumption: the crowdsourced labels and the data are independent conditioning on the ground truth. To the best of our knowledge, this is a very early algorithm that is both theoretically and empirically robust to the situation where some experts make highly correlated mistakes and some experts label effortlessly, without knowing the information structure among the experts. Our algorithm simultaneously aggregates the crowdsourced labels and learns an accurate data classifier. In addition, we propose a method to learn an accurate data-crowds forecaster that can employ both the data and the crowdsourced labels. At a high level, our algorithm trains a data classifier and a crowds aggregator simultaneously to maximize their "mutual information". This process will find the "information intersection" between the data and crowdsourced labels i.e. the ground truth label. The data-crowds forecaster can be easily constructed from the trained data classifier and the trained crowds aggregator. This algorithm allows the conditional dependency among the experts as long as the intersection assumption holds. We design the crowds aggregator as the "weighted average" of the experts. This simple "weighted average" form allows our algorithm to be both highly efficient in computing and theoretically robust to a large family of information structures (e.g. case (1), (2), (3) in Figure 1 (b)). Particularly, our algorithm works when there exists a subset of senior experts, whose identities are unknown, such that these senior experts have mutually independent labeling biases and it is sufficient to only use the seniors' information to predict the ground truth label. For other junior experts, they are allowed to have any dependency structure among themselves or between them and the senior experts.
2 RELATED WORK
A series of works consider the learning from crowds problem and mix the learning process and the aggregation process together. Raykar et al. (2010) reduce the learning from crowds problem to a maximum likelihood estimation (MLE) problem, and implement an EM algorithm to jointly learn the expertise of different experts and the parameters of a logistic regression classifier. Albarqouni et al. (2016) extend this method to combine with the deep learning model. Unlike our method, this MLE based algorithm is not robust to correlated mistakes. Recently, Guan et al. (2017) and Rodrigues & Pereira (2017) propose methods that model multiple experts individually and explicitly in neural
1Case (2)'s experts are also mutually independent, since always labeling class 1 has no correlation with anyone. We separate case (1) and (2) here to emphasize that case (2) has naive majority.
2

Under review as a conference paper at ICLR 2019

Figure 2: Medical image labeling example: we want to train a data classifier to classify the medical images into two classes: benign and malignant. Each image is labeled by several experts. The experts are from different hospitals, say hospital A, B, C. Each hospital has a senior who has a high expertise. We assume the seniors' labeling biases are mutually independent. However, for two juniors that were advised by the same senior before, they make highly correlated mistakes when labeling the images. We assume that 5 experts are from hospital A, 50 experts are from hospital B, and 5 experts are from hospital C. If we use majority vote to aggregate the labels, the aggregated result will be biased to hospital B. If we still pretend the experts' labeling noises are independent and apply the approaches that require independent mistakes, the aggregated result will still be biased to hospital B.

network. However, their works lack theoretical guarantees and are outperformed by our method in the experiments, especially in the naive majority case. Moreover, unlike our method, their methods cannot be used to employ both the data and the crowdsourced labels to forecast the ground truth.
Several learning from crowds works focus on modeling the experts. Whitehill et al. (2009) model both expert competence and image difficulty, but did not consider expert bias. Welinder et al. (2010) model each expert as a multidimensional classifier in an abstract feature space and consider both the bias of the expert and the difficulty of the image. Rodrigues et al. (2014) model the crowds by Gaussian process. However, these works are still not robust to correlated mistakes. We model the crowds via confusion matrix (Dawid & Skene, 1979) and do not consider the image difficulty, but our Max-MIG framework can be easily incorporated with any model of the experts and allow correlated mistakes.
Our method differs from the works that focus on inferring ground truth answers from the crowds' reports and then learn the classifier with the inferred ground truth (e.g. (Dawid & Skene, 1979; Zhou et al., 2012; Liu et al., 2012; Karger et al., 2014; Zhang et al., 2014; Dalvi et al., 2013; Ratner et al., 2016)) since our method simultaneously infers the ground truth and learns the classifier. In addition, our method provides a data-crowds forecaster while those works do not.
Our method is also closely related to co-training. Blum & Mitchell (1998) first propose the co-training framework: simultaneously training two classifiers to aggregate two views of data. Our method interprets joint learning from crowds as a co-training style problem. Most traditional co-training methods require weakly good classifier candidates (e.g. better than random guessing). We follow the general information theoretic framework proposed by Kong & Schoenebeck (2018) that does not have this requirement. However, Kong & Schoenebeck (2018) only provide theoretic framework and assume extremely high model complexity without considering the over-fitting issue, which is a too strong assumption for practice. Our work apply this framework to the learning from crowds problem and provide the proper design for the model complexity as well as the experimental validations.

3 METHOD

In this section, we formally define the problem, introduce our method, Max-MIG, and provide a theoretical validation for our method.

Notations For every integer M

every set A, we , we use [M ] to

use A to denote the denote {1, 2, . . . , M }.

set of all possible distributions For every matrix A = (Ai,j)i,j

over A. For  R+s×t, we

define log A as a s × t matrix such that its the (i, j)th entry is log(Ai,j). Similarly for every vector

v = (vi)i  R+s, we define log v as a vector such that its the ith entry is log(vi).

3

Under review as a conference paper at ICLR 2019

Problem statement There are N datapoints. Each datapoint x  I (e.g. the CT scan of a lung nodule) is labeled by M experts y[M] = {y1, y2, . . . , yM ym  C} (e.g. C = {benign, malignant}, 5 experts' labels: {benign, malignant, benign, benign, benign}). The datapoint x and the crowdsourced labels y[M] are related to a ground truth y  C (e.g. the pathological truth of the lung nodule).

We are aiming to simultaneously train a data classifier h and a crowds aggregator g such that

chro wI dsourCcepdreldaibcetslsthye[Mgr]oiunntod

truth y based on a prediction for

the datapoint x ground truth y.

 I, We

and also

g  CM  C want to learn

aggregates M a data-crowds

forecaster   I × CM  the crowdsourced labels

y[CMt]hatCf.orecasts

the

ground

truth

y

based

on

both

the

datapoint

x



I

and

3.1 MAX-MIG: AN INFORMATION THEORETIC APPROACH

Figure 3: Max-MIG overview: Step 1: finding the "information intersection" between the data and the crowdsourced labels: we train a data classifier h and a crowds aggregator g simultaneously to melaabacxehlismdyaizi[taMept]ohiiennittroxfai-mftoourteaucafaolsrtiengcf(oayrsmi[tMha]t(i)xoin)gaCinbyCM"fIowGretifhg(ehhtg,egdro,aupvn)edrwatgirtueht"ha. .WhgyepategurgnpreaertgahameteepstaerMrapmcertoewrCsd.oshfohumracanepdds g simultaneously to maximize their f -mutual information gain. We will show the maximum is the f -mutual information (a natural extension of mutual information, see Appendix B) between the data and the crowdsourced labels. Step 2: aggregating the "information intersection": after we obtain the best h, g, p that maximizes M IGf (h, g, p), we use them to construct a data-crowds forecaster  that forecasts ground truth based on both the datapoint and the crowdsourced labels. To calculate the f -mutual information gain, we reward them for the average "agreements" between wfthohereitrrheoeuiatpvuejtr,saagfsoers"hthaogewrsneaembmyeettnhatessk"g,rbie.eyet.wlhine(eexsni.)tIhnaetnuidritogivu(etylpi[yuM,tts]h)efo,rraeswthsaehroddwieffnnecrboeyuntrthategaesbsklasthc, kei.edli.antheas(,cxlaain)sdsaipfinudenrgits(ohyajt[ghMree]m)e with the crowds aggregator, while the punishment avoids them naively agreeing with each other, that is, both of them map everything to (1, 0, . . . , 0). The measurement of "agreement" depends on the selection of f . See formal definition for M IGf in (1).

Figure 3 illustrates the overview idea of our method. Here we formally introduce the building blocks of our method.

Data classifier h The data classifier h is a neural network with parameters . Its input is a datapoint x and its output is a distribution over C. We denote the set of all such data classifers by HNN .

Crowds aggregator g The crowds aggregator g is a "weighted average" function to aggregate

crowdsourced labels with parameters {Wm  labels provided by M experts for a datapoint

RC and

×C
its

o}umMt=p1utanisdabd.iIsttsriibnuptuiot ny[oMve]risC t.hBeycrroewprdessoeunrtcinegd

each ym  y[M] as an one-hot vector e(ym) = (0, . . . , 1, . . . , 0)  {0, 1} C where only the ymth

4

Under review as a conference paper at ICLR 2019

entry of e(ym) is 1,
g(y[M]; {Wm}Mm=1, b) = softmax( M Wm  e(ym) + b)
m=1
where Wm  e(ym) is equivalent to pick the ymth column of matrix Wm, as shown in Figure 3. We denote the set of all such crowds aggregators by GW A.

Data-crowds forecaster  Given a data classifier h, a crowds aggregator g and a distribution

p = (pc)c  on both the

daCtapovoeinrtthxeacnldastsheesc, rtohwe ddsaotau-rccreodwldasbefolsreyc[aMst]e, risc, othnasttrfuocrteecdasbtys

the

ground

truth

based

(x, y[M]; h, g, p) = Normalize

(

h(x)c



g(y[M pc

]

)c

)c

where

Normalize(v)

=

v c vc

.

f -mutual information gain M IGf f -mutual information gain M IGf measures the "mutual information" between two hypotheses, which is proposed by Kong & Schoenebeck (2018). Given Nypi1=,dy(ai2pt,ac.p).oc.i,nytiMs Cx,1i,Csx,d2teh,fie.n.f.e-,dmxaNustuthaelIianvwfeohrraemgreaet"ieoaangcrhgeaedimnatebanepttsow"ienbetenxtwhi eaiesnndlahgb,aeanlsedsdogcbifyaotreMdthwecisrtoahmwadehstyoapsuekrrcpmeadirnalumasbetethelesr average "agreements" between h and g for the different tasks, that is,

M

I

Gf

({xi},

{yi[M

]};

h,

g,

p)

=

1 N

f
i

h(xi)c  g(yi[M])c cC pc

-

1 N (N -

1)

ij

f f

h(xi)c  g(yj[M])c cC pc

 

(1)

where f is a convex function satisfying f (1) = 0 and f  is the Fenchel duality of f . We can use Table 1 as reference for f () and f (f ()).

Table 1: Reference for common f -divergences and corresponding M IGf 's building blocks. This table is induced from Nowozin et al. (2016).

f -divergence

f (t)

f (K) f (f (K))

KL divergence t log t

1 + log K K

Pearson 2 Jensen-Shannon

(t - 1)2

-(t

+

1)

log

t+1 2

+

t

log

t

2(K - 1)

log

2K 1+K

K2 - 1

-

log(

2 1+K

)

Since the parameters of h is  and M IGf ({xi}, {yi[M]}; h, g, p) as

the

parameters

of

g

is

{Wm}mM=1

and

b,

we

naturally

rewrite

M IGf ({xi}, {yi[M]}; , {Wm}mM=1, b, p).

We the

gseroekun{dt,ru{tWh ims p}Mm =(1e,.gb.,pp}

that maximizes = (0.8, 0.2) i.e.

M IGf . Later we will show that when the the ground truth is benign with probability

prior of 0.8 and

malignant with probability 0.2 a priori), the best b and p are log p and p respectively. Thus, we

can set b as log p and only tune p. When we have side information about the prior p, we can fix

parameter p as p, and fix parameter b as log p.

5

Under review as a conference paper at ICLR 2019

3.2 THEORETICAL JUSTIFICATION

This section provides a theoretical validation for Max-MIG, i.e., maximizing the f -mutual information gain over HNN and GW A finds the "information intersection" between the data and the crowdsourced labels. In Appendix D, we compare our method with the MLE method (Raykar et al., 2010) theoretically and show that unlike our method, MLE is not robust to the correlated mistakes case.

Recall that we assume that conditioning on the ground truth, the data and the crowdsourced labels

are mutually independent. Thus, we can naturally define the "information intersection" as a pair of data classifier and crowds aggregator h, g such that they both fully use their input to forecast the

ground truth. Kong & Schoenebeck (2018) shows that when we have infinite number of datapoints

and maximize over all possible data classifiers and crowds aggregators, the "information intersection" will maximize M IGf (h, g) to the f -mutual information (Appendix B) between the data and the

crowdsourced label. However, in practice, with finite number of datapoints, the data classifier and the

crowds aggregator space should be not only sufficiently rich to contain the "information intersection"

but also sufficiently simple to avoid over-fitting. Later, the experiment section will show that our

picked HNN and GW A are sufficient simple to avoid over-fitting. We assume the neural network

space is sufficiently rich. It remains sufficiently rich to contain g.

to

show

that

our

weighted

average

aggregator

space

GW A

is

Model and assumptions Each datapoint xi with crowdsourced labels provided by M experts yi1, ..., yiM are drawn i.i.d. from random variables X, Y 1, ..., Y M . Assumption 3.1 (Co-training assumption). X and Y [M] are independent conditioning on Y .

Note that we do not assume that the experts' labels are conditionally mutually independent. We define p  C as the prior for Y , i.e. pc = P (Y = c). Definition 3.2 (Information intersection). We define h, g and  such that

h(x)c = P (Y = c X = x) g(y[M])c = P (Y = c Y [M] = y[M]).

(x, y[M])c = P (Y = c X = x, Y [M] = y[M]) We call them Bayesian posterior data classifier / crowds aggregator / data-crowds forecaster. We call (h, g) the information intersection between the data and the crowdsourced labels.

We also assume the neural network space is sufficiently rich to contain h.

Assumption 3.3 (Richness of the neural networks). h  HNN .

Theorem 3.4. With assumption 3.1, 3.3, when there exists a subset of experts S  [M ] such that the experts in S are mutually independent conditioning on Y and Y S is a sufficient statistic for Y , i.e. P (Y = y Y [M] = y[M]) = P (Y = y Y S = yS) for every y  C, y[M]  CM , then (h, g, p) is a

maximizer of

hHN N

max
,gGW

A ,pC

EX,Y

[M ]

M

I

Gf

(h(X

),

g(Y

[M

]),

p)

and the maximum is the f -mutual information between X and Y [M]. Moreover, (x, y[M]) = (x, y[M]; h, g, p) for every x, y[M].

Our main theorem shows that if there exists a subset of senior experts such that these senior experts are mutually conditional independent and it is sufficient to only use the information from these senior experts, then Max-MIG finds the "information interstion". Note that we do not need to know the identities of the senior experts. For other junior experts, we allow any dependency structure among them and between them and the senior experts.

To show our results, we need that g can be represented as a

to show that GW A weighted average.

contains g, i.e. there exists proper In the independent mistakes case, we

weights such can construct

each expert's weight using her confusion matrix. Thus, in this case, each expert's weight represents

her expertise. In the general case, we can construct each senior expert's weight using her confusion

matrix and make the junior experts' weights zero. Due to space limitation, we defer the formal proofs

to Appendix C.

6

Under review as a conference paper at ICLR 2019
4 EXPERIMENT
In this section, we evaluate our method on image classification tasks with synthesized crowdsourced labels in various of settings.
4.1 DATASETS AND SETTINGS
Image datasets Three datasets are used in our experiments. The Dogs vs. Cats (Kaggle, 2013) dataset consists of 25, 000 images from 2 classes, dogs and cats, which is split into a 12, 500-image training set and a 12, 500-image test set. The CIFAR-10 (Krizhevsky et al., 2014) dataset consists of 60, 000 32 × 32 color images from 10 classes, which is split into a 50, 000-image training set and a 10, 000-image test set. The LUNA16 (Setio et al., 2016) dataset consists of 888 CT scans for lung nodule. We preprocessed the CT scans by generating 8106 50 × 50 gray-scale images, which is split into a 6484-image training set and a 1622-image testing set.
Synthesized crowdsourced labels For each information structure in Figure 1, we generate two groups of crowdsourced labels for each dataset: labels provided by (H) experts with relatively high expertise; (L) experts with relatively low expertise. For each of the situation (H) (L), all three cases have the same senior experts. Case 4.1. (Independent mistakes) Ms senior experts are mutually conditionally independent. Case 4.2. (Naive majority) Ms senior experts are mutually conditional independent, while other Mj junior experts label all datapoints as the first class effortlessly. Case 4.3. (Correlated mistakes) Ms senior experts are mutually conditional independent, and each junior expert copies one of the senior experts.
Related methods Our method Max-MIG is compared with: Majority Vote, training the network with the major vote labels from all the experts; Crowd Layer, the method proposed by Rodrigues & Pereira (2017); Docter Net, the method proposed by Guan et al. (2017) and AggNet, the method proposed by Albarqouni et al. (2016).
Networks We follow the four layers network in Rodrigues & Pereira (2017) on Dogs vs. Cats and LUNA16 and use VGG-16 on CIFAR-10 for the backbone of the data classifier h.
We defer other implementation details to appendix A.
4.2 RESULTS
We train the data classifier h on the three datasets through our method2 and other related methods. The accuracy of the trained data classifiers on the test set are shown in Figure 4. We also show the accuracy of our data-crowds forecaster on the test set.
For the performances of the trained data classifiers, our method Max-MIG (red) almost outperform all other methods in every experiment. The majority vote method (grey) fails in the naive majority situation. The AggNet has reasonably good performances when the experts are conditionally independent, including the naive majority case since naive expert is independent with everything, while it is outperformed by us a lot in the correlated mistakes case. This matches the theory in Appendix D: the AggNet is based on MLE and MLE fails in correlated mistakes case. The Doctor Net (green) and the Crowd Layer (blue) methods are not robust to the naive majority case. Our data-crowds forecaster (light red) performs better than our data classifier, which shows that our data-crowds forecaster actually takes advantage of the additional information, the crowdsourced labels, to give a better result.
Recall that in the experiments, for each of the situation (H) (L), all three cases have the same senior experts. Thus, all three cases' crowdsourced labels have the same amount of information. The results show that Max-MIG has similar performances for all three cases for each of the situation (H) (L), which validates our theoretical result: Max-MIG finds the "information intersection" between the data and the crowdsourced labels.
2The results of Max-MIG are based on KL divergence. The results for other divergences are similar.
7

Under review as a conference paper at ICLR 2019
Figure 4: Results on Dogs vs. Cats, CIFAR-10, LUNA16.
5 CONCLUSION AND DISCUSSION
We propose an information theoretic approach, Max-MIG, for joint learning from crowds, with a common assumption: the crowdsourced labels and the data are independent conditioning on the ground truth. We provide theoretical validation to our approach and compare our approach experimentally with previous methods (Doctor net (Guan et al., 2017), Crowd layer (Rodrigues & Pereira, 2017), Aggnet (Albarqouni et al., 2016)) under several different information structures. Each of the previous methods is not robust to at least one information structure and our method is robust to all and almost outperform all other methods in every experiment. To the best of our knowledge, our approach is a very early algorithm that is both theoretically and empirically robust to the situation where some people make highly correlated mistakes and some people label effortlessly, without knowing the information structure among the crowds. Our current implementation of Max-MIG has several limitations. For example, we implement the aggregator using a simple linear model, which cannot handle the case when the senior experts are latent and cannot be linearly inferred from the junior experts. However, note that if the aggregator space is sufficiently rich, the Max-MIG approach is still able to handle any situation as long as the "information intersection" assumption holds. One potential future direction is designing more complicated but still trainable aggregator space. ACKNOWLEDGMENTS Blinded for review.
8

Under review as a conference paper at ICLR 2019
REFERENCES
Shadi Albarqouni, Christoph Baur, Felix Achilles, Vasileios Belagiannis, Stefanie Demirci, and Nassir Navab. Aggnet: deep learning from crowds for mitosis detection in breast cancer histology images. IEEE transactions on medical imaging, 35(5):1313­1321, 2016.
Syed Mumtaz Ali and Samuel D Silvey. A general class of coefficients of divergence of one distribution from another. Journal of the Royal Statistical Society. Series B (Methodological), pp. 131­142, 1966.
Avrim Blum and Tom Mitchell. Combining labeled and unlabeled data with co-training. In Proceedings of the eleventh annual conference on Computational learning theory, pp. 92­100. ACM, 1998.
Imre Csisza´r, Paul C Shields, et al. Information theory and statistics: A tutorial. Foundations and Trends® in Communications and Information Theory, 1(4):417­528, 2004.
Nilesh Dalvi, Anirban Dasgupta, Ravi Kumar, and Vibhor Rastogi. Aggregating crowdsourced binary ratings. In Proceedings of the 22nd international conference on World Wide Web, pp. 285­294. ACM, 2013.
Alexander Philip Dawid and Allan M Skene. Maximum likelihood estimation of observer error-rates using the em algorithm. Applied statistics, pp. 20­28, 1979.
Melody Y Guan, Varun Gulshan, Andrew M Dai, and Geoffrey E Hinton. Who said what: Modeling individual labelers improves classification. arXiv preprint arXiv:1703.08774, 2017.
Kaggle. Dogs vs. cats competition. https://www.kaggle.com/c/dogs-vs-cats, 2013.
David R Karger, Sewoong Oh, and Devavrat Shah. Budget-optimal task allocation for reliable crowdsourcing systems. Operations Research, 62(1):1­24, 2014.
Y. Kong and G. Schoenebeck. An Information Theoretic Framework For Designing Information Elicitation Mechanisms That Reward Truth-telling. ArXiv e-prints, May 2016.
Yuqing Kong and Grant Schoenebeck. Water from two rocks: Maximizing the mutual information. In Proceedings of the 2018 ACM Conference on Economics and Computation, pp. 177­194. ACM, 2018.
Alex Krizhevsky, Vinod Nair, and Geoffrey Hinton. The cifar-10 dataset. online: http://www. cs. toronto. edu/kriz/cifar. html, 2014.
Qiang Liu, Jian Peng, and Alexander T Ihler. Variational inference for crowdsourcing. In Advances in neural information processing systems, pp. 692­700, 2012.
Sebastian Nowozin, Botond Cseke, and Ryota Tomioka. f-gan: Training generative neural samplers using variational divergence minimization. In Advances in Neural Information Processing Systems, pp. 271­279, 2016.
Alexander J Ratner, Christopher M De Sa, Sen Wu, Daniel Selsam, and Christopher Re´. Data programming: Creating large training sets, quickly. In Advances in Neural Information Processing Systems, pp. 3567­3575, 2016.
Vikas C Raykar, Shipeng Yu, Linda H Zhao, Gerardo Hermosillo Valadez, Charles Florin, Luca Bogoni, and Linda Moy. Learning from crowds. Journal of Machine Learning Research, 11(Apr): 1297­1322, 2010.
Filipe Rodrigues and Francisco Pereira. Deep learning from crowds. arXiv preprint arXiv:1709.01779, 2017.
Filipe Rodrigues, Francisco Pereira, and Bernardete Ribeiro. Gaussian process classification and active learning with multiple annotators. In International Conference on Machine Learning, pp. 433­441, 2014.
9

Under review as a conference paper at ICLR 2019

Arnaud Arindra Adiyoso Setio, Francesco Ciompi, Geert Litjens, Paul Gerke, Colin Jacobs, Sarah J Van Riel, Mathilde Marie Winkler Wille, Matiullah Naqibullah, Clara I Sa´nchez, and Bram van Ginneken. Pulmonary nodule detection in ct images: false positive reduction using multi-view convolutional networks. IEEE transactions on medical imaging, 35(5):1160­1169, 2016.
Peter Welinder, Steve Branson, Pietro Perona, and Serge J Belongie. The multidimensional wisdom of crowds. In Advances in neural information processing systems, pp. 2424­2432, 2010.
Jacob Whitehill, Ting-fan Wu, Jacob Bergsma, Javier R Movellan, and Paul L Ruvolo. Whose vote should count more: Optimal integration of labels from labelers of unknown expertise. In Advances in neural information processing systems, pp. 2035­2043, 2009.
Yuchen Zhang, Xi Chen, Denny Zhou, and Michael I Jordan. Spectral methods meet em: A provably optimal algorithm for crowdsourcing. In Advances in neural information processing systems, pp. 1260­1268, 2014.
Denny Zhou, Sumit Basu, Yi Mao, and John C Platt. Learning from the wisdom of crowds by minimax entropy. In Advances in neural information processing systems, pp. 2195­2203, 2012.

A EXPERIMENTS DETAILS

A.1 EXPERTS' EXPERTISE

For each information structure in Figure 1, we generate two groups of crowdsourced labels for each dataset: labels provided by (H) experts with relatively high expertise; (L) experts with relatively low expertise. For each of the situation (H) (L), all three cases have the same senior experts.

Case A.1. (Independent Ms = 5. (L) Ms = 10.

mistakes)

Ms

senior

experts

are

mutually

conditionally

independent.

(H)

Dogs vs. Cats In situation (H), some senior experts are more familiar with cats, while others make better judgments on dogs. For example, expert A is more familiar with cats, her expertise for dogs/cats is 0.6/0.8 in the sense that if the ground truth is dog/cat, she labels the image as "dog"/"cat" with probability 0.6/0.8 respectively. Similarly, other experts expertise are B:0.6/0.6, C:0.9/0.6, D:0.7/0.7, E:0.6/0.7.
In situation (L), all ten seniors' expertise are 0.55/0.55.

CIFAR-10 In situation (H), we generate experts who may make mistakes in distinguishing the hard pairs: cat/dog, deer/horse, airplane/bird, automobile/trunk, frog/ship, but can perfectly distinguish other easy pairs (e.g. cat/frog), which makes sense in practice. When they cannot distinguish the pair, some of them may label the pair randomly and some of them label the pair the same class. In detail, for each hard pair, expert A label the pair the same class (e.g. A always labels the image as "cat" when the image has cats or dogs), expert B labels the pair uniformly at random (e.g. B labels the image as "cat" with probability 0.5 and "dog" with probability 0.5 when the image has cats or dogs). Expert C is familiar with mammals so she can distinguish cat/dog and deer/hose, while for other hard pairs, she label each of them uniformly at random. Expert D is familiar with vehicles so she can distinguish airplane/bird, automobile/trunk and frog/ship, while for other hard pairs, she always label each of them the same class. Expert E does not have special expertise. For each hard pair, Expert E labels them correctly with probability 0.6.

In situation (L), all ten senior experts label each image correctly with probability 0.2 and label each

image

as

other

false

classes

uniformly

with

probability

0.8 9

.

LUNA16 In situation (H), some senior experts tend to label the image as "benign" while others tend to label the image as "malignant". Their expertise for benign/malignant are: A: 0.6/0.9, B:0.7/0.7, C:0.9/0.6, D:0.6/0.7, E:0.7/0.6.
In situation (L), all ten seniors' expertise are 0.6/0.6.

10

Under review as a conference paper at ICLR 2019

Case A.2.

Mj Mj

junior = 15.

(Naive experts

majority) Ms senior label all data as the

experts are mutually conditional first class effortlessly. (H) Ms =

independent, while 5, Mj = 5. (L) Ms

other = 10,

For Dogs vs. Cats, all junior experts label everything as "cat". For CIFAR-10, all junior experts label everything as "airplane". For LUNA16, all junior experts label everything as "benign".

Case A.3. (Correlated mistakes) Ms junior expert copies one of the senior

senior experts are experts.(H) Ms =

mutually conditional 5, Mj = 5. (L) Ms =

independent, 10, Mj = 2.

and

each

For Dogs vs. Cats, CIFAR-10 and LUNA16, in situation (H), two junior experts copy expert A's labels and three junior experts copy expert C's labels; in situation (L), one junior expert copies expert A's labels and another junior expert copies expert C's labels.

A.2 IMPLEMENTATION DETAILS
Networks For Dogs vs. Cats and LUNA16, we follow the four layers network in Rodrigues & Pereira (2017). We use Adam optimizer with learning rate 1.0 × 10-4 for both the data classifier and the crowds aggregator. Batch size is set to 16. For CIFAR-10, we use VGG-16 as the backbone. We use Adam optimizer with learning rate 1.0 × 10-3 for the data classifier and 1.0 × 10-4 for the crowds aggregator. Batch size is set to 64. For our method MAX-MIG's crowds aggregator, for Dogs vs. Cats and LUNA16, we set the bias b as log p and only tune p. For CIFAR-10, we fix the prior distribution p to be the uniform distribution p0 and fix the bias b as log p0.
Initialization For AggNet and our method Max-MIG, we initialize the parameters {Wm}m using the method in Raykar et al. (2010):

Wcm,c

=

log

N

i=1

Q(yi

N

= c)1(yim
Q(yi = c)

=

c)

i=1

(2)

where 1(yim = c) = 1 when yim = c and 1(yim = c) = 0 when yim  c and N is the total number of

datapoints.

We

average

all

crowdsourced

labels

to

obtain

Q(yi

=

c)

=

1 M

M
m=1

1(yim

=

c).

For Crowd Layer method, we initialize the weight matrices using identity matrix on Dogs vs. Cats and LUNA as Rodrigues & Pereira (2017) suggest. However, this initialization method leads to pretty bad results on CIFAR-10. Thus, we use (2) for Crowd Layer on CIFAR-10, which is the best practice in our experiments.

B f -MUTUAL INFORMATION

B.1 f -DIVERGENCE AND FENCHEL'S DUALITY

fno-dni-vsyermgmenectreic(Amlei a&suSreilovfeyth, e19d6if6fe;rCenscisezba´ertweteaeln.,d2is0t0ri4b)utiofn-dpivergencaendDdfistributi×onq

R  

is a and

is defined to be

Df (p, q) = p()f


q() p()

where f  R  R is a convex function and f (1) = 0.

B.2 f -MUTUAL INFORMATION

Given two random variables X, two probability measures where

UY Xw,hYoissetrheeajloizianttiodnistsrpibaucteioanreof (XXa,nYd)aYnd, lVetXU,YX,iYs

and VX,Y the product

be of

11

Under review as a conference paper at ICLR 2019

the marginal distributions of X and Y . Formally, for every pair of (x, y)  X × Y , UX,Y (X = x, Y = y) = Pr[X = x, Y = y] VX,Y (X = x, Y = y) = Pr[X = x] Pr[Y = y].
If UX,Y is very different from VX,Y , the mutual information between X and Y should be high since knowing X changes the belief for Y a lot. If UX,Y equals to VX,Y , the mutual information between X and Y should be zero since X is independent with Y . Intuitively, the "distance" between UX,Y and VX,Y represents the mutual information between them.
Definition B.1 (f -mutual information (Kong & Schoenebeck, 2016)). The f -mutual information between X and Y is defined as
M If (X, Y ) = Df (UX,Y , VX,Y )
where Df is f -divergence. f -mutual information is always non-negative.
Kong & Schoenebeck (2016) show that if we measure the amount of information by f -mutual information, any "data processing" on either of the random variables will decrease the amount of information crossing them. With this property, Kong & Schoenebeck (2016) propose an information theoretic mechanism design framework using f -mutual information. Kong & Schoenebeck (2018) reduce the co-training problem to a mechanism design problem and extend the information theoretic framework in Kong & Schoenebeck (2016) to address the co-training problem.

C PROOF OF THEOREM 3.4

This section provides the formal proofs to our main theorem. Definition C.1 (Confusion matrix). For each expert m, we define her confusion matrix as Cm = (Ccm,c )c,c  R C × C where Ccm,c = P (Y m = c Y = c).

We denote the set of all possible classifiers by H and the set of all possible aggregators by G. Lemma C.2. (Kong & Schoenebeck, 2018) With assumption 3.1, 3.3, (h, g, p) is a maximizer of

max
hH ,g G ,pC

EX,Y

[M ]

M

I

Gf

(h(X

),

g(Y

[M

]),

p)

and the maximum is the f mutual information between X and Y [M], M If (X, Y [M]). Moreover, (x, y[M]) = (x, y[M]; h, g, p) for every x, y[M].

Proposition C.3. [Independent mistakes] With assumption 3.1, 3.3, if the experts are mutually independent conditioning on Y , then g  GW A and

g(y[M]) = g(y[M]; {log Cm}Mm=1, log p)
for every y[M]  CM . This implies that (h, g, p) is a maximizer of

hHN N

max
,gGW

A ,pC

EX,Y

[M ]

M

I

Gf

(h(X

),

g(Y

[M

]),

p)

and the maximum is the f mutual information between X and Y [M], M If (X, Y [M]). Moreover, (x, y[M]) = (x, y[M]; h, g, p) for every x, y[M].

Proof. We will show that when the experts are mutually conditionally independent, then

g(y[M]) = g(y[M]; {log Cm}Mm=1, log p).

This also implies HNN , we can see
maximum is the f

t(mhhautt,uggal,ipnfGo)rWmisAaat.imoBnaaxbsiemetdwizeoeenrnotXhf emaranexsduhYltH[oMNfN] .L,gMemGoWmreAao,pvCe.r2,C,LMbeymImaGsafsu(Chm.,2igna,glpsto)haiamtndhpltihees

that (x, y[M]) = (x, y[M]; h, g, p) for every x, y[M].

12

Under review as a conference paper at ICLR 2019

For every c  C, every y[M]  CM , (log g(y[M]))c = log P (Y = c Y [M] = y[M]) = log P (Y [M] = y[M] Y = c)P (Y = c) - log P (Y [M] = y[M]) = M log P (Y m = ym Y = c) + log P (Y = c) - log P (Y [M] = y[M])
m=1
Thus,

M
(

log Cm  e(ym) + log p)c =

M

log P (Y m = ym Y

= c) + log P (Y

= c)

m=1

m=1

=(log g(y[M]))c + log P (Y [M] = y[M])

Then,

(sof tmax(
m

log Cm



e(ym)

+

log p))c

(log g(y[M]))c+log P (Y [M]=y[M])
= e ec (log g(y[M]))c+log P (Y [M]=y[M])

=

e(log g(y[M]))c c e(log g(y[M]))c

=(g (y[M ] ))c (since g(y[M])  C, c g(y[M])c = 1)

Thus,

g(y[M]) = sof tmax( log Cm  e(ym) + log p) = g(y[M]; {log Cm}Mm=1, log p).
m

We restate our main theorem, Theorem 3.4, here with more details and prove it.
Theorem 3.4 (General case). With assumption 3.1, 3.3, when there exists a subset of experts S  [M ] such that the experts in S are mutually independent conditioning on Y and Y S is a sufficient statistic for Y , i.e. P (Y = y Y [M] = y[M]) = P (Y = y Y S = yS) for every y  C, y[M]  CM , then g  GW A and
g(y[M]) = g(y[M]; {Wm}m, log p) for every y[M]  CM where for every m  S, Wm = log Cm, for every m  S, Wm = 03. This implies that (h, g, p) is a maximizer of

hHN N

max
,gGW

A ,pC

EX,Y

[M ]

M

I

Gf

(h(X

),

g(Y

[M

]),

p)

and the maximum is the f mutual information between X and Y [M], M If (X, Y [M]). Moreover, (x, y[M]) = (x, y[M]; h, g, p) for every x, y[M].

Proof. Like the proof for the above proposition, we need to show that
g(y[M]) = g(y[M]; {Wm}m, log p). This also implies that g  GW A as well as the other results of the theorem. When Y S is a sufficient statistic for Y , we have
g(y[M]) = g(yS ).
3We denote the matrix whose entries are all zero by 0.

13

Under review as a conference paper at ICLR 2019

Proposition C.3 shows that g(yS ) = g(yS ; {log Cs}sS , log p).
Thus, we have g(y[M]) = g(yS ) = g(yS ; {log Cs}sS , log p) = g(y[M]; {Wm}m, log p)
where for every m  S, Wm = log Cm, for every m  S, Wm = 0.

D THEORETICAL COMPARISONS WITH MLE
Raykar et al. (2010) propose a maximum likelihood estimation (MLE) based method in the learning from crowds scenario. Raykar et al. (2010) use logistic regression and Aggnet(Albarqouni et al., 2016) extends it to combine with the deep learning model. In this section, we will theoretically show that these MLE based methods can handle the independent mistakes case but cannot handle even the simplest correlated mistakes case--only one expert reports meaningful information and all other experts always report the same meaningless information--which can be handled by our method. Therefore, in addition to the experimental results, theoretically, our method is still better than these MLE based methods. We first introduce these MLE based methods.
Let  be the parameter that control the distribution over X and Y . Let m be the parameter that controls the distribution over Y m and Y . For each each x, y[M],

P (Y [M] = y[M] X = x; , {m}m)

(3)

= P (Y = y X = x; )P (Y [M] = y[M] Y = y; {m}m)

y
(conditioning on Y , X and Y [M] are independent)

= P (Y = y X = x; )Mm=1P (Y m = ym Y = y; m)
y
(experts are mutually conditional independent.)

The MLE based method seeks  and m that maximize

N
log P (Y = c X = xi; )Mm=1P (Yim = yim Y = c; m)
i=1 c

To theoretically compare it with our method, we use our language to reinterpret the above MLE based method.

We define T as the set of all C × C transition matrices with each row summing to 1.

For each expert m, we define Wm  T as a parameter that is associated with m.

Given a set of data classifiers h transition matrices W1, W2, ,

H WM

where h  T that

 I  C, maximize

the

MLE

based

method

seeks

h



H

and

N

log
i=1

c

h(xi)cmM=1Wcm,yim .

The expectation of the above formula is EX,Y [M] log h(X)cMm=1Wcm,Y m .
c

Note that Raykar et al. (2010) set the data classifiers space H as all logistic regression classifiers and Albarqouni et al. (2016) extend this space to the neural network space.

14

Under review as a conference paper at ICLR 2019

Proposition D.1 (MLE works for independent mistakes). If the experts are mutually independent conditioning on Y, then h and C1, C2, , CM are a maximizer of

max
h,W1 ,W2 ,,Wm T

EX,Y [M]

log

c

h(X)cmM=1Wcm,Y m .

Proof.

EX,Y [M] log h(X )cmM=1Wcm,Y m
c

= P (X = x, Y [M] = y[M]) log h(x)cMm=1Wcm,ym

x,y[M ]

c

= P (X = x)

P (Y [M] = y[M] X = x) log h(x)cMm=1Wcm,ym

x y[M]

c

Since W1, W2, , Wm  T , thus,

h(x)cmM=1Wcm,ym = 1
y[M]CM cC

which means (cC h(x)cmM=1Wcm,ym )y[M Moreover, for any two distribution vectors

] can be seen as a distribution over all p and q, p  log q  p  log p, thus

possible

y[M ]



CM

.

P (X = x)

P (Y [M] = y[M] X = x) log h(x)cMm=1Wcm,ym

x y[M]

c

 P (X = x) P (Y [M] = y[M] X = x) log P (Y [M] = y[M] X = x)

x y[M]

= P (X = x)

P (Y [M] = y[M] X = x) log h(x)cMm=1Ccm,Y m

x y[M]

c

(see equation (3))

Thus, the MLE based method handles the independent mistakes case. However, we will construct a counter example to show that it cannot handle a simple correlated mistakes case which can be handled by our method. Example D.2 (A simple correlated mistakes case). We assume there are only two classes C = {0, 1} and the prior over Y is uniform, that is, P (Y = 0) = P (Y = 1) = 0.5. We also assume that X = Y .
There are 101 experts and one of the experts, say her the first expert, fully knows Y and always reports Y 1 = Y . The second expert knows nothing and every time flips a random unbiased coin whose randomness is independent with X, Y . She reports Y 2 = 1 when she gets head and reports Y 2 = 0 otherwise. The rest of experts copy the second expert's answer all the time, i.e. Y m = Y 2, for m  2.

Note that our method can handle this simple correlated mistakes case and will give all useless experts weight zero based on Theorem 3.4.

We define h0 as a data classifier h0

hdaastamculacshsihfiigerhesur clihkethliahtoho0d(xth)a0n=hh0, (wxh)i1ch=

0.5. We will show this meaningless shows that in this simple correlated

mistakes case, the MLE based method will obtain meaningless results.

We define a data classifier h's maximal expected likelihood as

max
W1 ,W2 ,,Wm T

EX,Y [M]

log

c

h(X)cmM=1Wcm,Y m .

Theorem D.3 (MLE fails for correlated mistakes). In the scenario defined by Example D.2, the

meaningless classifier h

classifier h0's maximal expected likelihood is 's maximal expected likelihood is 100 log 0.5

at 

least log log 0.5.

0.5

and

the

Bayesian

posterior

15

Under review as a conference paper at ICLR 2019

The above theorem implies that the MLE based method fails in Example D.2. Proof. For the Bayesian posterior classifier h, since X = Y = Y 1 and Y 2 =  = Y M , then h(X = c) is an one-hot vector where the cth entry is 1 and everything is determined by the realizations of Y and Y 2.

EX,Y [M] log h(X )cMm=1Wcm,ym
c

= P (X = x, Y [M] = y[M]) log h(x)cmM=1Wcm,ym

x,y[M ]

c

= P (X = c, Y [M] = y[M]) log h(c)cmM=1Wcm,ym

c,y[M ]

c

= P (Y = c)P (Y 2 = c) log Wc1,cmM=2Wcm,c
c,c

(X = Y = Y 1, Y 2 =  = Y M )

M
= P (Y = c) log Wc1,c +

P (Y = c) P (Y 2 = c) log Wcm,c

c

m=2 c

c

M


P (Y = c) P (Y 2 = c) log Wcm,c

m=2 c

c

M


P (Y = c) P (Y 2 = c) log P (Y 2 = c)

m=2 c

c

(W m is a transition matrix and p  log q  p  log p)

=100 log 0.5

(Y 2 equals 0 with probability 0.5 and 1 with probability 0.5 as well)

The maximal value is obtained by setting W1 as an identity matrix and setting W2 =  = WM

as

0.5 0.5

0.5 0.5

. Thus, the Bayesian posterior data classifier h's maximal expected likelihood is

100 log 0.5. For the meaningless data classifier h0,

EX,Y [M] log h0(X )cmM=1Wcm,ym
c

= P (X = x, Y [M] = y[M]) log h0(x)cMm=1Wcm,ym

x,y[M ]

c

= P (X = x, Y [M] = y[M]) log 0.5 mM=1Wcm,ym

x,y[M ]

c

= P (Y = c)P (Y 2 = c) log 0.5 mM=1Wcm,c
c,c c

Note when we set every Wm as an identity matrix, the above formula equals log 0.5. Thus, the meaningless data classifier h0's maximal expected likelihood is at least log 0.5.

16

